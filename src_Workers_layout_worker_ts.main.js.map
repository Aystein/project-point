{"version":3,"file":"src_Workers_layout_worker_ts.main.js","sources":["./src/Layouts/Globals.ts","./src/WebGL/Math/Rectangle.ts","./src/Workers/layout.worker.ts","./src/Workers/util.ts"],"sourcesContent":["export const POINT_RADIUS = 0.012;\r\n","import { VectorLike } from '../../Interfaces';\r\n\r\nexport interface IRectangle {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nexport class Rectangle {\r\n  x: number;\r\n\r\n  y: number;\r\n\r\n  width: number;\r\n\r\n  height: number;\r\n\r\n  constructor(x: number, y: number, width: number, height: number) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n\r\n  within(vector: VectorLike) {\r\n    return (\r\n      vector.x > this.x &&\r\n      vector.x < this.x + this.width &&\r\n      vector.y > this.y &&\r\n      vector.y < this.y + this.height\r\n    );\r\n  }\r\n\r\n  serialize(): IRectangle {\r\n    return {\r\n      x: this.x,\r\n      y: this.y,\r\n      width: this.width,\r\n      height: this.height,\r\n    };\r\n  }\r\n\r\n  percent(xp: number, yp: number) {\r\n    return { x: this.x + this.width * xp,\r\n      y: this.y + this.height * yp }\r\n  }\r\n\r\n  percentX(x: number) {\r\n    return (x - this.x) / this.width\r\n  }\r\n\r\n  percentY(y: number) {\r\n    return (y - this.y) / this.height\r\n  }\r\n\r\n  get centerX() {\r\n    return this.x + this.width / 2;\r\n  }\r\n\r\n  get centerY() {\r\n    return this.y + this.height / 2;\r\n  }\r\n\r\n  static deserialize(dump: IRectangle) {\r\n    return new Rectangle(dump.x, dump.y, dump.width, dump.height);\r\n  }\r\n}\r\n","/* eslint-disable no-restricted-globals */\r\nimport { forceNormalizationNew } from \"../Layouts/ForceUtil\";\r\nimport { POINT_RADIUS } from \"../Layouts/Globals\";\r\nimport { IRectangle } from \"../WebGL/Math/Rectangle\";\r\nimport { fillRect } from \"./util\";\r\n\r\ntype Commands = 'init' | 'fill_rect'\r\n\r\ninterface Props {\r\n    data: {\r\n        N: number;\r\n        area: IRectangle;\r\n        type: Commands;\r\n        radius?: number;\r\n    };\r\n}\r\n\r\nself.onmessage = ({\r\n    data: { N, area, type, radius = POINT_RADIUS },\r\n}: Props) => {\r\n    /** Generate N points in a rectangle that has the same aspect ratio as the area */\r\n    if (type === 'fill_rect') {\r\n        const { Y } = fillRect(area, N, radius);\r\n\r\n        self.postMessage({\r\n            type: 'finish',\r\n            Y,\r\n        });\r\n    }\r\n\r\n}","import { POINT_RADIUS } from \"../Layouts/Globals\";\r\nimport { IRectangle, Rectangle } from \"../WebGL/Math/Rectangle\";\r\n\r\nexport function UpdateText(self: Window, value: string) {\r\n  self.postMessage({\r\n    type: 'message',\r\n    message: 'Calculating embedding ...',\r\n  });\r\n}\r\n\r\n\r\n\r\n\r\nexport function fillRect(area: IRectangle, N: number, radius = POINT_RADIUS) {\r\n  if (area.width === 0 || area.height === 0) console.log(area)\r\n\r\n  const c = radius * 3;\r\n  const A = c ** 2 * N;\r\n\r\n  let aspectRatio = area.width / area.height;\r\n\r\n  let h = Math.sqrt(A / aspectRatio);\r\n  let w = A / h;\r\n\r\n  w = Math.ceil(w / c);\r\n  h = Math.ceil(h / c);\r\n\r\n  const offX = area.x + area.width / 2 - (w / 2) * c;\r\n  const offY = area.y + area.height / 2 - (h / 2) * c;\r\n\r\n  const Y = Array.from({ length: N }).map((_, i) => ({ x: (i % w) * c, y: Math.floor(i / w) * c }))\r\n  return { Y: Y.map((value) => ({ x: offX + value.x + c / 2, y: offY + value.y + c / 2 })), bounds: Rectangle.deserialize({ x: offX, y: offY, width: (w) * c, height: (h) * c }) as Rectangle };\r\n}"],"names":["POINT_RADIUS","Rectangle","x","y","width","height","constructor","within","vector","serialize","percent","xp","yp","percentX","percentY","centerX","centerY","deserialize","dump","self","onmessage","data","N","area","type","radius","Y","fillRect","postMessage","console","log","c","A","h","Math","sqrt","w","ceil","offX","offY","Array","from","length","map","_","i","floor","value","bounds"],"mappings":"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"}
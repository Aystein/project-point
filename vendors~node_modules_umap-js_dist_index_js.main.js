(self.webpackChunkliqvis=self.webpackChunkliqvis||[]).push([["vendors~node_modules_umap-js_dist_index_js"],{709057:function(t,e,r){"use strict";r.r(e),r.d(e,{isAnyArray:function(){return s}});let o=Object.prototype.toString;function s(t){let e=o.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},258493:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return s}});var o=r("709057");function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,o.isAnyArray)(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,s=void 0===r?0:r,i=e.toIndex,n=void 0===i?t.length:i;if(s<0||s>=t.length||!Number.isInteger(s))throw Error("fromIndex must be a positive integer smaller than length");if(n<=s||n>t.length||!Number.isInteger(n))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[s],h=s+1;h<n;h++)t[h]>a&&(a=t[h]);return a}},900520:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return s}});var o=r("709057");function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,o.isAnyArray)(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,s=void 0===r?0:r,i=e.toIndex,n=void 0===i?t.length:i;if(s<0||s>=t.length||!Number.isInteger(s))throw Error("fromIndex must be a positive integer smaller than length");if(n<=s||n>t.length||!Number.isInteger(n))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[s],h=s+1;h<n;h++)t[h]<a&&(a=t[h]);return a}},295132:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return n}});var o=r("709057"),s=r("258493"),i=r("900520");function n(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,o.isAnyArray)(t)){if(0===t.length)throw TypeError("input must not be empty")}else throw TypeError("input must be an array");if(void 0!==r.output){if(!(0,o.isAnyArray)(r.output))throw TypeError("output option must be an array if specified");e=r.output}else e=Array(t.length);var n=(0,i.default)(t),a=(0,s.default)(t);if(n===a)throw RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=r.min,l=void 0===h?r.autoMinMax?n:0:h,u=r.max,f=void 0===u?r.autoMinMax?a:1:u;if(l>=f)throw RangeError("min option must be smaller than max option");for(var c=(f-l)/(a-n),m=0;m<t.length;m++)e[m]=(t[m]-n)*c+l;return e}},568286:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return s}});let o=Object.prototype.toString;function s(t){return o.call(t).endsWith("Array]")}},265751:function(t,e,r){"use strict";function o(t,e,r){let o=0,s=r(e);for(let e=0;e<t.x.length;e++)o+=Math.abs(t.y[e]-s(t.x[e]));return o}r.r(e),r.d(e,{default:function(){return o}})},528890:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return n}});var o=r("568286"),s=r("265751"),i=r("351509");function n(t,e,r={}){let n,{maxIterations:a=100,gradientDifference:h=.1,damping:l=0,errorTolerance:u=.01,minValues:f,maxValues:c,initialValues:m}=r;if(l<=0)throw Error("The damping option must be a positive number");if(t.x&&t.y){if(!(0,o.default)(t.x)||t.x.length<2||!(0,o.default)(t.y)||t.y.length<2)throw Error("The data parameter elements must be an array with more than 2 points");else if(t.x.length!==t.y.length)throw Error("The data parameter elements must have the same size")}else throw Error("The data parameter must have x and y elements");let g=m||Array(e.length).fill(1),p=g.length;if(c=c||Array(p).fill(Number.MAX_SAFE_INTEGER),f=f||Array(p).fill(Number.MIN_SAFE_INTEGER),c.length!==f.length)throw Error("minValues and maxValues must be the same size");if(!(0,o.default)(g))throw Error("initialValues must be an array");let d=(0,s.default)(t,g,e),w=d<=u;for(n=0;n<a&&!w;n++){g=(0,i.default)(t,g,l,h,e);for(let t=0;t<p;t++)g[t]=Math.min(Math.max(f[t],g[t]),c[t]);if(isNaN(d=(0,s.default)(t,g,e)))break;w=d<=u}return{parameterValues:g,parameterError:d,iterations:n}}},351509:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return s}});var o=r("316954");function s(t,e,r,s,i){let n=r*s*s,a=o.Matrix.eye(e.length,e.length,n),h=i(e),l=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)l[e]=h(t.x[e]);let u=function(t,e,r,s,i){let n=r.length,a=t.x.length,h=Array(n);for(let o=0;o<n;o++){h[o]=Array(a);let n=r.slice();n[o]+=s;let l=i(n);for(let r=0;r<a;r++)h[o][r]=e[r]-l(t.x[r])}return new o.Matrix(h)}(t,l,e,s,i),f=function(t,e){let r=t.x.length,s=Array(r);for(let o=0;o<r;o++)s[o]=[t.y[o]-e[o]];return new o.Matrix(s)}(t,l),c=(0,o.inverse)(a.add(u.mmul(u.transpose())));return(e=(e=new o.Matrix([e])).sub(c.mmul(u).mmul(f).mul(s).transpose())).to1DArray()}},810850:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,s,i=r("709057"),n=r("295132");let a=" ".repeat(2),h=" ".repeat(4);function l(t,e={}){let{maxRows:r=15,maxColumns:o=10,maxNumSize:s=8,padMinus:i="auto"}=e;return`${t.constructor.name} {
${a}[
${h}${function(t,e,r,o,s){let{rows:i,columns:n}=t,a=Math.min(i,e),l=Math.min(n,r),f=[];if("auto"===s){s=!1;t:for(let e=0;e<a;e++)for(let r=0;r<l;r++)if(0>t.get(e,r)){s=!0;break t}}for(let e=0;e<a;e++){let r=[];for(let i=0;i<l;i++)r.push(function(t,e,r){return(t>=0&&r?` ${u(t,e-1)}`:u(t,e)).padEnd(e)}(t.get(e,i),o,s));f.push(`${r.join(" ")}`)}return l!==n&&(f[f.length-1]+=` ... ${n-r} more columns`),a!==i&&f.push(`... ${i-e} more rows`),f.join(`
${h}`)}(t,r,o,s,i)}
${a}]
${a}rows: ${t.rows}
${a}columns: ${t.columns}
}`}function u(t,e){let r=t.toString();if(r.length<=e)return r;let o=t.toFixed(e);if(o.length>e&&(o=t.toFixed(Math.max(0,e-(o.length-e)))),o.length<=e&&!o.startsWith("0.000")&&!o.startsWith("-0.000"))return o;let s=t.toExponential(e);return s.length>e&&(s=t.toExponential(Math.max(0,e-(s.length-e)))),s.slice(0)}function f(t,e,r){let o=r?t.rows:t.rows-1;if(e<0||e>o)throw RangeError("Row index out of range")}function c(t,e,r){let o=r?t.columns:t.columns-1;if(e<0||e>o)throw RangeError("Column index out of range")}function m(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw RangeError("vector size must be the same as the number of columns");return e}function g(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw RangeError("vector size must be the same as the number of rows");return e}function p(t,e){if(!i.isAnyArray(e))throw TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw RangeError("row indices are out of range")}function d(t,e){if(!i.isAnyArray(e))throw TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw RangeError("column indices are out of range")}function w(t,e,r,o,s){if(5!=arguments.length)throw RangeError("expected 4 arguments");if(v("startRow",e),v("endRow",r),v("startColumn",o),v("endColumn",s),e>r||o>s||e<0||e>=t.rows||r<0||r>=t.rows||o<0||o>=t.columns||s<0||s>=t.columns)throw RangeError("Submatrix indices are out of range")}function y(t,e=0){let r=[];for(let o=0;o<t;o++)r.push(e);return r}function v(t,e){if("number"!=typeof e)throw TypeError(`${t} must be a number`)}function b(t){if(t.isEmpty())throw Error("Empty matrix has no elements to index")}class M{static from1DArray(t,e,r){if(t*e!==r.length)throw RangeError("data length does not match given dimensions");let o=new S(t,e);for(let s=0;s<t;s++)for(let t=0;t<e;t++)o.set(s,t,r[s*e+t]);return o}static rowVector(t){let e=new S(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new S(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new S(t,e)}static ones(t,e){return new S(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw TypeError("options must be an object");let{random:o=Math.random}=r,s=new S(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)s.set(r,t,o());return s}static randInt(t,e,r={}){if("object"!=typeof r)throw TypeError("options must be an object");let{min:o=0,max:s=1e3,random:i=Math.random}=r;if(!Number.isInteger(o))throw TypeError("min must be an integer");if(!Number.isInteger(s))throw TypeError("max must be an integer");if(o>=s)throw RangeError("min must be smaller than max");let n=s-o,a=new S(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=o+Math.round(i()*n);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let o=Math.min(t,e),s=this.zeros(t,e);for(let t=0;t<o;t++)s.set(t,t,r);return s}static diag(t,e,r){let o=t.length;void 0===e&&(e=o),void 0===r&&(r=e);let s=Math.min(o,e,r),i=this.zeros(e,r);for(let e=0;e<s;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,o=t.columns,s=new S(r,o);for(let i=0;i<r;i++)for(let r=0;r<o;r++)s.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return s}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,o=t.columns,s=new this(r,o);for(let i=0;i<r;i++)for(let r=0;r<o;r++)s.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return s}static checkMatrix(t){return M.isMatrix(t)?t:new S(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,o=!0,s=!1;for(;t<this.rows&&o;){for(e=0,s=!1;e<this.columns&&!1===s;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(s=!0,r=e):(o=!1,s=!0);t++}return o}isReducedEchelonForm(){let t=0,e=0,r=-1,o=!0,s=!1;for(;t<this.rows&&o;){for(e=0,s=!1;e<this.columns&&!1===s;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(s=!0,r=e):(o=!1,s=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(o=!1);t++}return o}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let o=e;for(let s=e;s<t.rows;s++)t.get(s,r)>t.get(o,r)&&(o=s);if(0===t.get(o,r))r++;else{t.swapRows(e,o);let s=t.get(e,r);for(let o=r;o<t.columns;o++)t.set(e,o,t.get(e,o)/s);for(let o=e+1;o<t.rows;o++){let s=t.get(o,r)/t.get(e,r);t.set(o,r,0);for(let i=r+1;i<t.columns;i++)t.set(o,i,t.get(o,i)-t.get(e,i)*s)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,o=r-1;for(;o>=0;)if(0===t.maxRow(o))o--;else{let s=0,i=!1;for(;s<r&&!1===i;)1===t.get(o,s)?i=!0:s++;for(let r=0;r<o;r++){let i=t.get(r,s);for(let n=s;n<e;n++){let e=t.get(r,n)-i*t.get(o,n);t.set(r,n,e)}}o--}return t}set(){throw Error("set method is unimplemented")}get(){throw Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw TypeError("columns must be a positive integer");let o=new S(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)o.setSubMatrix(this,this.rows*t,this.columns*e);return o}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){f(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return S.rowVector(this.getRow(t))}setRow(t,e){f(this,t),e=m(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){f(this,t),f(this,e);for(let r=0;r<this.columns;r++){let o=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,o)}return this}getColumn(t){c(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return S.columnVector(this.getColumn(t))}setColumn(t,e){c(this,t),e=g(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){c(this,t),c(this,e);for(let r=0;r<this.rows;r++){let o=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,o)}return this}addRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){f(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){c(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw Error(`invalid option: ${t}`)}}maxIndex(){b(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.get(r,o)>t&&(t=this.get(r,o),e[0]=r,e[1]=o);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw Error(`invalid option: ${t}`)}}minIndex(){b(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.get(r,o)<t&&(t=this.get(r,o),e[0]=r,e[1]=o);return e}maxRow(t){if(f(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){f(this,t),b(this);let e=this.get(t,0),r=[t,0];for(let o=1;o<this.columns;o++)this.get(t,o)>e&&(e=this.get(t,o),r[1]=o);return r}minRow(t){if(f(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){f(this,t),b(this);let e=this.get(t,0),r=[t,0];for(let o=1;o<this.columns;o++)this.get(t,o)<e&&(e=this.get(t,o),r[1]=o);return r}maxColumn(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){c(this,t),b(this);let e=this.get(0,t),r=[0,t];for(let o=1;o<this.rows;o++)this.get(o,t)>e&&(e=this.get(o,t),r[0]=o);return r}minColumn(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){c(this,t),b(this);let e=this.get(0,t),r=[0,t];for(let o=1;o<this.rows;o++)this.get(o,t)<e&&(e=this.get(o,t),r[0]=o);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){M.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw RangeError("vectors do not have the same size");let r=0;for(let o=0;o<e.length;o++)r+=e[o]*t[o];return r}mmul(t){t=S.checkMatrix(t);let e=this.rows,r=this.columns,o=t.columns,s=new S(e,o),i=new Float64Array(r);for(let n=0;n<o;n++){for(let e=0;e<r;e++)i[e]=t.get(e,n);for(let t=0;t<e;t++){let e=0;for(let o=0;o<r;o++)e+=this.get(t,o)*i[o];s.set(t,n,e)}}return s}strassen2x2(t){t=S.checkMatrix(t);let e=new S(2,2),r=this.get(0,0),o=t.get(0,0),s=this.get(0,1),i=t.get(0,1),n=this.get(1,0),a=t.get(1,0),h=this.get(1,1),l=t.get(1,1),u=(r+h)*(o+l),f=(n+h)*o,c=r*(i-l),m=h*(a-o),g=(r+s)*l;return e.set(0,0,u+m-g+(s-h)*(a+l)),e.set(0,1,c+g),e.set(1,0,f+m),e.set(1,1,u-f+c+(n-r)*(o+i)),e}strassen3x3(t){t=S.checkMatrix(t);let e=new S(3,3),r=this.get(0,0),o=this.get(0,1),s=this.get(0,2),i=this.get(1,0),n=this.get(1,1),a=this.get(1,2),h=this.get(2,0),l=this.get(2,1),u=this.get(2,2),f=t.get(0,0),c=t.get(0,1),m=t.get(0,2),g=t.get(1,0),p=t.get(1,1),d=t.get(1,2),w=t.get(2,0),y=t.get(2,1),v=t.get(2,2),b=(r-i)*(-c+p),M=(-r+i+n)*(f-c+p),x=(i+n)*(-f+c),E=r*f,R=(-r+h+l)*(f-m+d),N=(-r+h)*(m-d),k=(h+l)*(-f+m),A=(-s+l+u)*(p+w-y),z=(s-u)*(p-y),I=s*w,C=(l+u)*(-w+y),T=(-s+n+a)*(d+w-v),V=(s-a)*(d-v),_=(n+a)*(-w+v);return e.set(0,0,E+I+o*g),e.set(0,1,(r+o+s-i-n-l-u)*p+M+x+E+A+I+C),e.set(0,2,E+R+k+(r+o+s-n-a-h-l)*d+I+T+_),e.set(1,0,b+n*(-f+c+g-p-d-w+v)+M+E+I+T+V),e.set(1,1,b+M+x+E+a*y),e.set(1,2,I+T+V+_+i*m),e.set(2,0,E+R+N+l*(-f+m+g-p-d-w+y)+A+z+I),e.set(2,1,A+z+I+C+h*c),e.set(2,2,E+R+N+k+u*v),e}mmulStrassen(t){t=S.checkMatrix(t);let e=this.clone(),r=e.rows,o=e.columns,s=t.rows,i=t.columns;function n(t,e,r){let o=t.rows,s=t.columns;if(o===e&&s===r)return t;{let o=M.zeros(e,r);return o=o.setSubMatrix(t,0,0)}}o!==s&&console.warn(`Multiplying ${r} x ${o} and ${s} x ${i} matrix: dimensions do not match.`);let a=Math.max(r,s),h=Math.max(o,i);return e=n(e,a,h),t=n(t,a,h),function t(e,r,o,s){if(o<=512||s<=512)return e.mmul(r);o%2==1&&s%2==1?(e=n(e,o+1,s+1),r=n(r,o+1,s+1)):o%2==1?(e=n(e,o+1,s),r=n(r,o+1,s)):s%2==1&&(e=n(e,o,s+1),r=n(r,o,s+1));let i=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),h=e.subMatrix(0,i-1,0,a-1),l=r.subMatrix(0,i-1,0,a-1),u=e.subMatrix(0,i-1,a,e.columns-1),f=r.subMatrix(0,i-1,a,r.columns-1),c=e.subMatrix(i,e.rows-1,0,a-1),m=r.subMatrix(i,r.rows-1,0,a-1),g=e.subMatrix(i,e.rows-1,a,e.columns-1),p=r.subMatrix(i,r.rows-1,a,r.columns-1),d=t(M.add(h,g),M.add(l,p),i,a),w=t(M.add(c,g),l,i,a),y=t(h,M.sub(f,p),i,a),v=t(g,M.sub(m,l),i,a),b=t(M.add(h,u),p,i,a),x=t(M.sub(c,h),M.add(l,f),i,a),S=t(M.sub(u,g),M.add(m,p),i,a),E=M.add(d,v);E.sub(b),E.add(S);let R=M.add(y,b),N=M.add(w,v),k=M.sub(d,w);k.add(y),k.add(x);let A=M.zeros(2*E.rows,2*E.columns);return(A=(A=(A=(A=A.setSubMatrix(E,0,0)).setSubMatrix(R,E.rows,0)).setSubMatrix(N,0,E.columns)).setSubMatrix(k,E.rows,E.columns)).subMatrix(0,o-1,0,s-1)}(e,t,a,h)}scaleRows(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let o=new S(this.rows,this.columns);for(let t=0;t<this.rows;t++){let s=this.getRow(t);s.length>0&&n(s,{min:e,max:r,output:s}),o.setRow(t,s)}return o}scaleColumns(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let o=new S(this.rows,this.columns);for(let t=0;t<this.columns;t++){let s=this.getColumn(t);s.length&&n(s,{min:e,max:r,output:s}),o.setColumn(t,s)}return o}flipRows(){let t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),o=this.get(e,this.columns-1-r);this.set(e,r,o),this.set(e,this.columns-1-r,t)}return this}flipColumns(){let t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),o=this.get(this.rows-1-r,e);this.set(r,e,o),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=S.checkMatrix(t);let e=this.rows,r=this.columns,o=t.rows,s=t.columns,i=new S(e*o,r*s);for(let n=0;n<e;n++)for(let e=0;e<r;e++)for(let r=0;r<o;r++)for(let a=0;a<s;a++)i.set(o*n+r,s*e+a,this.get(n,e)*t.get(r,a));return i}kroneckerSum(t){if(t=S.checkMatrix(t),!this.isSquare()||!t.isSquare())throw Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,o=this.kroneckerProduct(S.eye(r,r)),s=S.eye(e,e).kroneckerProduct(t);return o.add(s)}transpose(){let t=new S(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=x){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=x){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,o){w(this,t,e,r,o);let s=new S(e-t+1,o-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=o;e++)s.set(i-t,e-r,this.get(i,e));return s}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw RangeError("Argument out of range");let o=new S(t.length,r-e+1);for(let s=0;s<t.length;s++)for(let i=e;i<=r;i++){if(t[s]<0||t[s]>=this.rows)throw RangeError(`Row index out of range: ${t[s]}`);o.set(s,i-e,this.get(t[s],i))}return o}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw RangeError("Argument out of range");let o=new S(r-e+1,t.length);for(let s=0;s<t.length;s++)for(let i=e;i<=r;i++){if(t[s]<0||t[s]>=this.columns)throw RangeError(`Column index out of range: ${t[s]}`);o.set(i-e,s,this.get(i,t[s]))}return o}setSubMatrix(t,e,r){if((t=S.checkMatrix(t)).isEmpty())return this;let o=e+t.rows-1,s=r+t.columns-1;w(this,e,o,r,s);for(let o=0;o<t.rows;o++)for(let s=0;s<t.columns;s++)this.set(e+o,r+s,t.get(o,s));return this}selection(t,e){p(this,t),d(this,e);let r=new S(t.length,e.length);for(let o=0;o<t.length;o++){let s=t[o];for(let t=0;t<e.length;t++){let i=e[t];r.set(o,t,this.get(s,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new S(this.rows,this.columns))}static copy(t,e){for(let[r,o,s]of t.entries())e.set(r,o,s);return e}sum(t){switch(t){case"row":return function(t){let e=y(t.rows);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[r]+=t.get(r,o);return e}(this);case"column":return function(t){let e=y(t.columns);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[o]+=t.get(r,o);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)e+=t.get(r,o);return e}(this);default:throw Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=y(t.rows,1);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[r]*=t.get(r,o);return e}(this);case"column":return function(t){let e=y(t.columns,1);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[o]*=t.get(r,o);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)e*=t.get(r,o);return e}(this);default:throw Error(`invalid option: ${t}`)}}mean(t){let e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{unbiased:r=!0,mean:o=this.mean(t)}=e;if("boolean"!=typeof r)throw TypeError("unbiased must be a boolean");switch(t){case"row":if(!i.isAnyArray(o))throw TypeError("mean must be an array");return function(t,e,r){let o=t.rows,s=t.columns,i=[];for(let n=0;n<o;n++){let o=0,a=0,h=0;for(let e=0;e<s;e++)o+=h=t.get(n,e)-r[n],a+=h*h;e?i.push((a-o*o/s)/(s-1)):i.push((a-o*o/s)/s)}return i}(this,r,o);case"column":if(!i.isAnyArray(o))throw TypeError("mean must be an array");return function(t,e,r){let o=t.rows,s=t.columns,i=[];for(let n=0;n<s;n++){let s=0,a=0,h=0;for(let e=0;e<o;e++)s+=h=t.get(e,n)-r[n],a+=h*h;e?i.push((a-s*s/o)/(o-1)):i.push((a-s*s/o)/o)}return i}(this,r,o);case void 0:if("number"!=typeof o)throw TypeError("mean must be a number");return function(t,e,r){let o=t.rows,s=t.columns,i=o*s,n=0,a=0,h=0;for(let e=0;e<o;e++)for(let o=0;o<s;o++)n+=h=t.get(e,o)-r,a+=h*h;return e?(a-n*n/i)/(i-1):(a-n*n/i)/i}(this,r,o);default:throw Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);let r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{center:r=this.mean(t)}=e;switch(t){case"row":if(!i.isAnyArray(r))throw TypeError("center must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e[r])}(this,r),this;case"column":if(!i.isAnyArray(r))throw TypeError("center must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e[o])}(this,r),this;case void 0:if("number"!=typeof r)throw TypeError("center must be a number");return!function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e)}(this,r),this;default:throw Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){let e=[];for(let r=0;r<t.rows;r++){let o=0;for(let e=0;e<t.columns;e++)o+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(o))}return e}(this);else if(!i.isAnyArray(r))throw TypeError("scale must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){let e=[];for(let r=0;r<t.columns;r++){let o=0;for(let e=0;e<t.rows;e++)o+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(o))}return e}(this);else if(!i.isAnyArray(r))throw TypeError("scale must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e[o])}(this,r),this;case void 0:if(void 0===r)r=function(t){let e=t.size-1,r=0;for(let o=0;o<t.columns;o++)for(let s=0;s<t.rows;s++)r+=Math.pow(t.get(s,o),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw TypeError("scale must be a number");return!function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e)}(this,r),this;default:throw Error(`invalid option: ${t}`)}}toString(t){return l(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function x(t,e){return t-e}M.prototype.klass="Matrix","undefined"!=typeof Symbol&&(M.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return l(this)});M.random=M.rand,M.randomInt=M.randInt,M.diagonal=M.diag,M.prototype.diagonal=M.prototype.diag,M.identity=M.eye,M.prototype.negate=M.prototype.neg,M.prototype.tensorProduct=M.prototype.kroneckerProduct;class S extends M{data;#t(t,e){if(this.data=[],Number.isInteger(e)&&e>=0)for(let r=0;r<t;r++)this.data.push(new Float64Array(e));else throw TypeError("nColumns must be a positive integer");this.rows=t,this.columns=e}constructor(t,e){if(super(),S.isMatrix(t))this.#t(t.rows,t.columns),S.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else if(i.isAnyArray(t)){let r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw TypeError("Data must be a 2D array with at least one element");this.data=[];for(let o=0;o<t;o++){if(r[o].length!==e)throw RangeError("Inconsistent array dimensions");if(!r[o].every(t=>"number"==typeof t))throw TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[o]))}this.rows=t,this.columns=e}else throw TypeError("First argument must be a positive number or an array")}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return f(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),f(this,t,!0),e=Float64Array.from(m(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){c(this,t);for(let e=0;e<this.rows;e++){let r=new Float64Array(this.columns-1);for(let o=0;o<t;o++)r[o]=this.data[e][o];for(let o=t+1;o<this.columns;o++)r[o-1]=this.data[e][o];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),c(this,t,!0),e=g(this,e);for(let r=0;r<this.rows;r++){let o=new Float64Array(this.columns+1),s=0;for(;s<t;s++)o[s]=this.data[r][s];for(o[s++]=e[r];s<this.columns+1;s++)o[s]=this.data[r][s-1];this.data[r]=o}return this.columns+=1,this}}o=M,s=S,o.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},o.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},o.prototype.addM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},o.add=function(t,e){let r=new s(t);return r.add(e)},o.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},o.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},o.prototype.subM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},o.sub=function(t,e){let r=new s(t);return r.sub(e)},o.prototype.subtract=o.prototype.sub,o.prototype.subtractS=o.prototype.subS,o.prototype.subtractM=o.prototype.subM,o.subtract=o.sub,o.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},o.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},o.prototype.mulM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},o.mul=function(t,e){let r=new s(t);return r.mul(e)},o.prototype.multiply=o.prototype.mul,o.prototype.multiplyS=o.prototype.mulS,o.prototype.multiplyM=o.prototype.mulM,o.multiply=o.mul,o.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},o.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},o.prototype.divM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},o.div=function(t,e){let r=new s(t);return r.div(e)},o.prototype.divide=o.prototype.div,o.prototype.divideS=o.prototype.divS,o.prototype.divideM=o.prototype.divM,o.divide=o.div,o.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},o.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},o.prototype.modM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},o.mod=function(t,e){let r=new s(t);return r.mod(e)},o.prototype.modulus=o.prototype.mod,o.prototype.modulusS=o.prototype.modS,o.prototype.modulusM=o.prototype.modM,o.modulus=o.mod,o.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},o.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},o.prototype.andM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},o.and=function(t,e){let r=new s(t);return r.and(e)},o.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},o.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},o.prototype.orM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},o.or=function(t,e){let r=new s(t);return r.or(e)},o.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},o.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},o.prototype.xorM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},o.xor=function(t,e){let r=new s(t);return r.xor(e)},o.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},o.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},o.prototype.leftShiftM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},o.leftShift=function(t,e){let r=new s(t);return r.leftShift(e)},o.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},o.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},o.prototype.signPropagatingRightShiftM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},o.signPropagatingRightShift=function(t,e){let r=new s(t);return r.signPropagatingRightShift(e)},o.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},o.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},o.prototype.rightShiftM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},o.rightShift=function(t,e){let r=new s(t);return r.rightShift(e)},o.prototype.zeroFillRightShift=o.prototype.rightShift,o.prototype.zeroFillRightShiftS=o.prototype.rightShiftS,o.prototype.zeroFillRightShiftM=o.prototype.rightShiftM,o.zeroFillRightShift=o.rightShift,o.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},o.not=function(t){let e=new s(t);return e.not()},o.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},o.abs=function(t){let e=new s(t);return e.abs()},o.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},o.acos=function(t){let e=new s(t);return e.acos()},o.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},o.acosh=function(t){let e=new s(t);return e.acosh()},o.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},o.asin=function(t){let e=new s(t);return e.asin()},o.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},o.asinh=function(t){let e=new s(t);return e.asinh()},o.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},o.atan=function(t){let e=new s(t);return e.atan()},o.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},o.atanh=function(t){let e=new s(t);return e.atanh()},o.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},o.cbrt=function(t){let e=new s(t);return e.cbrt()},o.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},o.ceil=function(t){let e=new s(t);return e.ceil()},o.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},o.clz32=function(t){let e=new s(t);return e.clz32()},o.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},o.cos=function(t){let e=new s(t);return e.cos()},o.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},o.cosh=function(t){let e=new s(t);return e.cosh()},o.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},o.exp=function(t){let e=new s(t);return e.exp()},o.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},o.expm1=function(t){let e=new s(t);return e.expm1()},o.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},o.floor=function(t){let e=new s(t);return e.floor()},o.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},o.fround=function(t){let e=new s(t);return e.fround()},o.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},o.log=function(t){let e=new s(t);return e.log()},o.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},o.log1p=function(t){let e=new s(t);return e.log1p()},o.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},o.log10=function(t){let e=new s(t);return e.log10()},o.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},o.log2=function(t){let e=new s(t);return e.log2()},o.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},o.round=function(t){let e=new s(t);return e.round()},o.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},o.sign=function(t){let e=new s(t);return e.sign()},o.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},o.sin=function(t){let e=new s(t);return e.sin()},o.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},o.sinh=function(t){let e=new s(t);return e.sinh()},o.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},o.sqrt=function(t){let e=new s(t);return e.sqrt()},o.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},o.tan=function(t){let e=new s(t);return e.tan()},o.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},o.tanh=function(t){let e=new s(t);return e.tanh()},o.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},o.trunc=function(t){let e=new s(t);return e.trunc()},o.pow=function(t,e){let r=new s(t);return r.pow(e)},o.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},o.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},o.prototype.powM=function(t){if(t=s.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this};class E extends M{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return S.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),S.isMatrix(t)){if(!t.isSymmetric())throw TypeError("not symmetric data");this.#e=S.copy(t,new S(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new S(t,t);else if(this.#e=new S(t),!this.isSymmetric())throw TypeError("not symmetric data")}clone(){let t=new E(this.diagonalSize);for(let[e,r,o]of this.upperRightEntries())t.set(e,r,o);return t}toMatrix(){return new S(this)}get(t,e){return this.#e.get(t,e)}set(t,e,r){return this.#e.set(t,e,r),this.#e.set(e,t,r),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);let r=e.slice();return r.splice(t,1),this.#e.addRow(t,r),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw RangeError("Mask size do not match with matrix size");let e=[];for(let[r,o]of t.entries())!o&&e.push(r);for(let t of(e.reverse(),e))this.removeCross(t);return this}toCompact(){let{diagonalSize:t}=this,e=Array(t*(t+1)/2);for(let r=0,o=0,s=0;s<e.length;s++)e[s]=this.get(o,r),++r>=t&&(r=++o);return e}static fromCompact(t){let e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);let o=new E(r);for(let s=0,i=0,n=0;n<e;n++)o.set(s,i,t[n]),++s>=r&&(s=++i);return o}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;){let r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;){let r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}}E.prototype.klassType="SymmetricMatrix";class R extends E{static isDistanceMatrix(t){return E.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new E(this)}clone(){let t=new R(this.diagonalSize);for(let[e,r,o]of this.upperRightEntries())e!==r&&t.set(e,r,o);return t}toCompact(){let{diagonalSize:t}=this,e=Array((t-1)*t/2);for(let r=1,o=0,s=0;s<e.length;s++)e[s]=this.get(o,r),++r>=t&&(r=++o+1);return e}static fromCompact(t){let e=t.length,r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);let o=new this(r);for(let s=1,i=0,n=0;n<e;n++)o.set(s,i,t[n]),++s>=r&&(s=++i+1);return o}}R.prototype.klassSubType="DistanceMatrix";class N extends M{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class k extends N{constructor(t,e,r){p(t,e),d(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class A extends M{constructor(t,e={}){let{rows:r=1}=e;if(t.length%r!=0)throw Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let o=this._calculateIndex(t,e);return this.data[o]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class z extends M{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class I{constructor(t){let e,r,o,s,i,n,a,h,l;let u=(t=z.checkMatrix(t)).clone(),f=u.rows,c=u.columns,m=new Float64Array(f),g=1;for(e=0;e<f;e++)m[e]=e;for(r=0,h=new Float64Array(f);r<c;r++){for(e=0;e<f;e++)h[e]=u.get(e,r);for(e=0;e<f;e++){for(o=0,l=Math.min(e,r),i=0;o<l;o++)i+=u.get(e,o)*h[o];h[e]-=i,u.set(e,r,h[e])}for(s=r,e=r+1;e<f;e++)Math.abs(h[e])>Math.abs(h[s])&&(s=e);if(s!==r){for(o=0;o<c;o++)n=u.get(s,o),u.set(s,o,u.get(r,o)),u.set(r,o,n);a=m[s],m[s]=m[r],m[r]=a,g=-g}if(r<f&&0!==u.get(r,r))for(e=r+1;e<f;e++)u.set(e,r,u.get(e,r)/u.get(r,r))}this.LU=u,this.pivotVector=m,this.pivotSign=g}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){let e,r,o;t=S.checkMatrix(t);let s=this.LU;if(s.rows!==t.rows)throw Error("Invalid matrix dimensions");if(this.isSingular())throw Error("LU matrix is singular");let i=t.columns,n=t.subMatrixRow(this.pivotVector,0,i-1),a=s.columns;for(o=0;o<a;o++)for(e=o+1;e<a;e++)for(r=0;r<i;r++)n.set(e,r,n.get(e,r)-n.get(o,r)*s.get(e,o));for(o=a-1;o>=0;o--){for(r=0;r<i;r++)n.set(o,r,n.get(o,r)/s.get(o,o));for(e=0;e<o;e++)for(r=0;r<i;r++)n.set(e,r,n.get(e,r)-n.get(o,r)*s.get(e,o))}return n}get determinant(){let t=this.LU;if(!t.isSquare())throw Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let o=0;o<r;o++)e*=t.get(o,o);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,o=new S(e,r);for(let s=0;s<e;s++)for(let e=0;e<r;e++)s>e?o.set(s,e,t.get(s,e)):s===e?o.set(s,e,1):o.set(s,e,0);return o}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,o=new S(e,r);for(let s=0;s<e;s++)for(let e=0;e<r;e++)s<=e?o.set(s,e,t.get(s,e)):o.set(s,e,0);return o}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function C(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class T{constructor(t){let e,r,o,s;let i=(t=z.checkMatrix(t)).clone(),n=t.rows,a=t.columns,h=new Float64Array(a);for(o=0;o<a;o++){let t=0;for(e=o;e<n;e++)t=C(t,i.get(e,o));if(0!==t){for(0>i.get(o,o)&&(t=-t),e=o;e<n;e++)i.set(e,o,i.get(e,o)/t);for(i.set(o,o,i.get(o,o)+1),r=o+1;r<a;r++){for(s=0,e=o;e<n;e++)s+=i.get(e,o)*i.get(e,r);for(s=-s/i.get(o,o),e=o;e<n;e++)i.set(e,r,i.get(e,r)+s*i.get(e,o))}}h[o]=-t}this.QR=i,this.Rdiag=h}solve(t){let e,r,o,s;t=S.checkMatrix(t);let i=this.QR,n=i.rows;if(t.rows!==n)throw Error("Matrix row dimensions must agree");if(!this.isFullRank())throw Error("Matrix is rank deficient");let a=t.columns,h=t.clone(),l=i.columns;for(o=0;o<l;o++)for(r=0;r<a;r++){for(s=0,e=o;e<n;e++)s+=i.get(e,o)*h.get(e,r);for(s=-s/i.get(o,o),e=o;e<n;e++)h.set(e,r,h.get(e,r)+s*i.get(e,o))}for(o=l-1;o>=0;o--){for(r=0;r<a;r++)h.set(o,r,h.get(o,r)/this.Rdiag[o]);for(e=0;e<o;e++)for(r=0;r<a;r++)h.set(e,r,h.get(e,r)-h.get(o,r)*i.get(e,o))}return h.subMatrix(0,l-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,o=r.columns,s=new S(o,o);for(t=0;t<o;t++)for(e=0;e<o;e++)t<e?s.set(t,e,r.get(t,e)):t===e?s.set(t,e,this.Rdiag[t]):s.set(t,e,0);return s}get orthogonalMatrix(){let t,e,r,o,s=this.QR,i=s.rows,n=s.columns,a=new S(i,n);for(r=n-1;r>=0;r--){for(t=0;t<i;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<n;e++)if(0!==s.get(r,r)){for(o=0,t=r;t<i;t++)o+=s.get(t,r)*a.get(t,e);for(o=-o/s.get(r,r),t=r;t<i;t++)a.set(t,e,a.get(t,e)+o*s.get(t,r))}}return a}}class V{constructor(t,e={}){let r;if((t=z.checkMatrix(t)).isEmpty())throw Error("Matrix must be non-empty");let o=t.rows,s=t.columns,{computeLeftSingularVectors:i=!0,computeRightSingularVectors:n=!0,autoTranspose:a=!1}=e,h=!!i,l=!!n,u=!1;if(o<s){if(a){o=(r=t.transpose()).rows,s=r.columns,u=!0;let e=h;h=l,l=e}else r=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose")}else r=t.clone();let f=Math.min(o,s),c=Math.min(o+1,s),m=new Float64Array(c),g=new S(o,f),p=new S(s,s),d=new Float64Array(s),w=new Float64Array(o),y=new Float64Array(c);for(let t=0;t<c;t++)y[t]=t;let v=Math.min(o-1,s),b=Math.max(0,Math.min(s-2,o)),M=Math.max(v,b);for(let t=0;t<M;t++){if(t<v){m[t]=0;for(let e=t;e<o;e++)m[t]=C(m[t],r.get(e,t));if(0!==m[t]){0>r.get(t,t)&&(m[t]=-m[t]);for(let e=t;e<o;e++)r.set(e,t,r.get(e,t)/m[t]);r.set(t,t,r.get(t,t)+1)}m[t]=-m[t]}for(let e=t+1;e<s;e++){if(t<v&&0!==m[t]){let s=0;for(let i=t;i<o;i++)s+=r.get(i,t)*r.get(i,e);s=-s/r.get(t,t);for(let i=t;i<o;i++)r.set(i,e,r.get(i,e)+s*r.get(i,t))}d[e]=r.get(t,e)}if(h&&t<v)for(let e=t;e<o;e++)g.set(e,t,r.get(e,t));if(t<b){d[t]=0;for(let e=t+1;e<s;e++)d[t]=C(d[t],d[e]);if(0!==d[t]){d[t+1]<0&&(d[t]=0-d[t]);for(let e=t+1;e<s;e++)d[e]/=d[t];d[t+1]+=1}if(d[t]=-d[t],t+1<o&&0!==d[t]){for(let e=t+1;e<o;e++)w[e]=0;for(let e=t+1;e<o;e++)for(let o=t+1;o<s;o++)w[e]+=d[o]*r.get(e,o);for(let e=t+1;e<s;e++){let s=-d[e]/d[t+1];for(let i=t+1;i<o;i++)r.set(i,e,r.get(i,e)+s*w[i])}}if(l)for(let e=t+1;e<s;e++)p.set(e,t,d[e])}}let x=Math.min(s,o+1);if(v<s&&(m[v]=r.get(v,v)),o<x&&(m[x-1]=0),b+1<x&&(d[b]=r.get(b,x-1)),d[x-1]=0,h){for(let t=v;t<f;t++){for(let e=0;e<o;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=v-1;t>=0;t--)if(0!==m[t]){for(let e=t+1;e<f;e++){let r=0;for(let s=t;s<o;s++)r+=g.get(s,t)*g.get(s,e);r=-r/g.get(t,t);for(let s=t;s<o;s++)g.set(s,e,g.get(s,e)+r*g.get(s,t))}for(let e=t;e<o;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<o;e++)g.set(e,t,0);g.set(t,t,1)}}if(l)for(let t=s-1;t>=0;t--){if(t<b&&0!==d[t])for(let e=t+1;e<s;e++){let r=0;for(let o=t+1;o<s;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<s;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<s;e++)p.set(e,t,0);p.set(t,t,1)}let E=x-1,R=Number.EPSILON;for(;x>0;){let t,e;for(t=x-2;t>=-1&&-1!==t;t--){let e=Number.MIN_VALUE+R*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(d[t])<=e||Number.isNaN(d[t])){d[t]=0;break}}if(t===x-2)e=4;else{let r;for(r=x-1;r>=t&&r!==t;r--){let e=(r!==x?Math.abs(d[r]):0)+(r!==t+1?Math.abs(d[r-1]):0);if(Math.abs(m[r])<=R*e){m[r]=0;break}}r===t?e=3:r===x-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=d[x-2];d[x-2]=0;for(let r=x-2;r>=t;r--){let o=C(m[r],e),i=m[r]/o,n=e/o;if(m[r]=o,r!==t&&(e=-n*d[r-1],d[r-1]=i*d[r-1]),l)for(let t=0;t<s;t++)o=i*p.get(t,r)+n*p.get(t,x-1),p.set(t,x-1,-n*p.get(t,r)+i*p.get(t,x-1)),p.set(t,r,o)}break}case 2:{let e=d[t-1];d[t-1]=0;for(let r=t;r<x;r++){let s=C(m[r],e),i=m[r]/s,n=e/s;if(m[r]=s,e=-n*d[r],d[r]=i*d[r],h)for(let e=0;e<o;e++)s=i*g.get(e,r)+n*g.get(e,t-1),g.set(e,t-1,-n*g.get(e,r)+i*g.get(e,t-1)),g.set(e,r,s)}break}case 3:{let e=Math.max(Math.abs(m[x-1]),Math.abs(m[x-2]),Math.abs(d[x-2]),Math.abs(m[t]),Math.abs(d[t])),r=m[x-1]/e,i=m[x-2]/e,n=d[x-2]/e,a=m[t]/e,u=d[t]/e,f=((i+r)*(i-r)+n*n)/2,c=r*n*(r*n),w=0;(0!==f||0!==c)&&(w=f<0?0-Math.sqrt(f*f+c):Math.sqrt(f*f+c),w=c/(f+w));let y=(a+r)*(a-r)+w,v=a*u;for(let e=t;e<x-1;e++){let r=C(y,v);0===r&&(r=Number.MIN_VALUE);let i=y/r,n=v/r;if(e!==t&&(d[e-1]=r),y=i*m[e]+n*d[e],d[e]=i*d[e]-n*m[e],v=n*m[e+1],m[e+1]=i*m[e+1],l)for(let t=0;t<s;t++)r=i*p.get(t,e)+n*p.get(t,e+1),p.set(t,e+1,-n*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,r);if(0===(r=C(y,v))&&(r=Number.MIN_VALUE),i=y/r,n=v/r,m[e]=r,y=i*d[e]+n*m[e+1],m[e+1]=-n*d[e]+i*m[e+1],v=n*d[e+1],d[e+1]=i*d[e+1],h&&e<o-1)for(let t=0;t<o;t++)r=i*g.get(t,e)+n*g.get(t,e+1),g.set(t,e+1,-n*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,r)}d[x-2]=y;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,l))for(let e=0;e<=E;e++)p.set(e,t,-p.get(e,t));for(;t<E&&!(m[t]>=m[t+1]);){;let e=m[t];if(m[t]=m[t+1],m[t+1]=e,l&&t<s-1)for(let r=0;r<s;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(h&&t<o-1)for(let r=0;r<o;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);t++}x--}}if(u){let t=p;p=g,g=t}this.m=o,this.n=s,this.s=m,this.U=g,this.V=p}solve(t){let e=this.threshold,r=this.s.length,o=S.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=e?o.set(t,t,0):o.set(t,t,1/this.s[t]);let s=this.U,i=this.rightSingularVectors,n=i.mmul(o),a=i.rows,h=s.rows,l=S.zeros(a,h);for(let t=0;t<a;t++)for(let e=0;e<h;e++){let o=0;for(let i=0;i<r;i++)o+=n.get(t,i)*s.get(e,i);l.set(t,e,o)}return l.mmul(t)}solveForDiagonal(t){return this.solve(S.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,o=t.columns,s=new S(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<o;r++)Math.abs(this.s[r])>e&&s.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,n=i.rows,a=i.columns,h=new S(r,n);for(let t=0;t<r;t++)for(let e=0;e<n;e++){let r=0;for(let o=0;o<a;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let o=0,s=r.length;o<s;o++)r[o]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return S.diag(this.s)}}function _(t,e,r=!1){return(t=z.checkMatrix(t),e=z.checkMatrix(e),r)?new V(t).solve(e):t.isSquare()?new I(t).solve(e):new T(t).solve(e)}class F{constructor(t,e={}){let r,o;let{assumeSymmetric:s=!1}=e;if(!(t=z.checkMatrix(t)).isSquare())throw Error("Matrix is not a square matrix");if(t.isEmpty())throw Error("Matrix must be non-empty");let i=t.columns,n=new S(i,i),a=new Float64Array(i),h=new Float64Array(i),l=t,u=!1;if(u=!!s||t.isSymmetric()){for(r=0;r<i;r++)for(o=0;o<i;o++)n.set(r,o,l.get(r,o));(function(t,e,r,o){let s,i,n,a,h,l,u,f;for(h=0;h<t;h++)r[h]=o.get(t-1,h);for(a=t-1;a>0;a--){for(l=0,f=0,n=0;l<a;l++)f+=Math.abs(r[l]);if(0===f)for(h=0,e[a]=r[a-1];h<a;h++)r[h]=o.get(a-1,h),o.set(a,h,0),o.set(h,a,0);else{for(l=0;l<a;l++)r[l]/=f,n+=r[l]*r[l];for(s=r[a-1],i=Math.sqrt(n),s>0&&(i=-i),e[a]=f*i,n-=s*i,r[a-1]=s-i,h=0;h<a;h++)e[h]=0;for(h=0;h<a;h++){for(s=r[h],o.set(h,a,s),i=e[h]+o.get(h,h)*s,l=h+1;l<=a-1;l++)i+=o.get(l,h)*r[l],e[l]+=o.get(l,h)*s;e[h]=i}for(h=0,s=0;h<a;h++)e[h]/=n,s+=e[h]*r[h];for(h=0,u=s/(n+n);h<a;h++)e[h]-=u*r[h];for(h=0;h<a;h++){for(s=r[h],i=e[h],l=h;l<=a-1;l++)o.set(l,h,o.get(l,h)-(s*e[l]+i*r[l]));r[h]=o.get(a-1,h),o.set(a,h,0)}}r[a]=n}for(a=0;a<t-1;a++){if(o.set(t-1,a,o.get(a,a)),o.set(a,a,1),0!==(n=r[a+1])){for(l=0;l<=a;l++)r[l]=o.get(l,a+1)/n;for(h=0;h<=a;h++){for(l=0,i=0;l<=a;l++)i+=o.get(l,a+1)*o.get(l,h);for(l=0;l<=a;l++)o.set(l,h,o.get(l,h)-i*r[l])}}for(l=0;l<=a;l++)o.set(l,a+1,0)}for(h=0;h<t;h++)r[h]=o.get(t-1,h),o.set(t-1,h,0);o.set(t-1,t-1,1),e[0]=0})(i,h,a,n),function(t,e,r,o){let s,i,n,a,h,l,u,f,c,m,g,p,d,w,y,v;for(n=1;n<t;n++)e[n-1]=e[n];e[t-1]=0;let b=0,M=0,x=Number.EPSILON;for(l=0;l<t;l++){for(M=Math.max(M,Math.abs(r[l])+Math.abs(e[l])),u=l;u<t&&!(Math.abs(e[u])<=x*M);){;u++}if(u>l)do{for(s=r[l],c=C(f=(r[l+1]-s)/(2*e[l]),1),f<0&&(c=-c),r[l]=e[l]/(f+c),r[l+1]=e[l]*(f+c),m=r[l+1],i=s-r[l],n=l+2;n<t;n++)r[n]-=i;for(b+=i,f=r[u],p=g=1,d=g,w=e[l+1],y=0,v=0,n=u-1;n>=l;n--)for(h=0,d=p,p=g,v=y,s=g*e[n],i=g*f,c=C(f,e[n]),e[n+1]=y*c,y=e[n]/c,f=(g=f/c)*r[n]-y*s,r[n+1]=i+y*(g*s+y*r[n]);h<t;h++)i=o.get(h,n+1),o.set(h,n+1,y*o.get(h,n)+g*i),o.set(h,n,g*o.get(h,n)-y*i);f=-y*v*d*w*e[l]/m,e[l]=y*f,r[l]=g*f}while(Math.abs(e[l])>x*M);r[l]=r[l]+b,e[l]=0}for(n=0;n<t-1;n++){for(h=n,f=r[n],a=n+1;a<t;a++)r[a]<f&&(h=a,f=r[a]);if(h!==n)for(a=0,r[h]=r[n],r[n]=f;a<t;a++)f=o.get(a,n),o.set(a,n,o.get(a,h)),o.set(a,h,f)}}(i,h,a,n)}else{let t=new S(i,i),e=new Float64Array(i);for(o=0;o<i;o++)for(r=0;r<i;r++)t.set(r,o,l.get(r,o));(function(t,e,r,o){let s,i,n,a,h,l,u;let f=t-1;for(l=1;l<=f-1;l++){for(u=0,a=l;a<=f;a++)u+=Math.abs(e.get(a,l-1));if(0!==u){for(n=0,a=f;a>=l;a--)r[a]=e.get(a,l-1)/u,n+=r[a]*r[a];for(i=Math.sqrt(n),r[l]>0&&(i=-i),n-=r[l]*i,r[l]=r[l]-i,h=l;h<t;h++){for(s=0,a=f;a>=l;a--)s+=r[a]*e.get(a,h);for(s/=n,a=l;a<=f;a++)e.set(a,h,e.get(a,h)-s*r[a])}for(a=0;a<=f;a++){for(s=0,h=f;h>=l;h--)s+=r[h]*e.get(a,h);for(s/=n,h=l;h<=f;h++)e.set(a,h,e.get(a,h)-s*r[h])}r[l]=u*r[l],e.set(l,l-1,u*i)}}for(a=0;a<t;a++)for(h=0;h<t;h++)o.set(a,h,a===h?1:0);for(l=f-1;l>=1;l--)if(0!==e.get(l,l-1)){for(a=l+1;a<=f;a++)r[a]=e.get(a,l-1);for(h=l;h<=f;h++){for(i=0,a=l;a<=f;a++)i+=r[a]*o.get(a,h);for(i=i/r[l]/e.get(l,l-1),a=l;a<=f;a++)o.set(a,h,o.get(a,h)+i*r[a])}}})(i,t,e,n),function(t,e,r,o,s){let i,n,a,h,l,u,f,c,m,g,p,d,w,y,v,b=t-1,M=t-1,x=Number.EPSILON,S=0,E=0,R=0,N=0,k=0,A=0,z=0,I=0;for(i=0;i<t;i++)for((i<0||i>M)&&(r[i]=s.get(i,i),e[i]=0),n=Math.max(i-1,0);n<t;n++)E+=Math.abs(s.get(i,n));for(;b>=0;){for(h=b;h>0&&(0===(A=Math.abs(s.get(h-1,h-1))+Math.abs(s.get(h,h)))&&(A=E),!(Math.abs(s.get(h,h-1))<x*A));){;h--}if(h===b)s.set(b,b,s.get(b,b)+S),r[b]=s.get(b,b),e[b]=0,b--,I=0;else if(h===b-1){if(f=s.get(b,b-1)*s.get(b-1,b),z=Math.sqrt(Math.abs(N=(R=(s.get(b-1,b-1)-s.get(b,b))/2)*R+f)),s.set(b,b,s.get(b,b)+S),s.set(b-1,b-1,s.get(b-1,b-1)+S),c=s.get(b,b),N>=0){for(z=R>=0?R+z:R-z,r[b-1]=c+z,r[b]=r[b-1],0!==z&&(r[b]=c-f/z),e[b-1]=0,e[b]=0,A=Math.abs(c=s.get(b,b-1))+Math.abs(z),k=Math.sqrt((R=c/A)*R+(N=z/A)*N),R/=k,N/=k,n=b-1;n<t;n++)z=s.get(b-1,n),s.set(b-1,n,N*z+R*s.get(b,n)),s.set(b,n,N*s.get(b,n)-R*z);for(i=0;i<=b;i++)z=s.get(i,b-1),s.set(i,b-1,N*z+R*s.get(i,b)),s.set(i,b,N*s.get(i,b)-R*z);for(i=0;i<=M;i++)z=o.get(i,b-1),o.set(i,b-1,N*z+R*o.get(i,b)),o.set(i,b,N*o.get(i,b)-R*z)}else r[b-1]=c+R,r[b]=c+R,e[b-1]=z,e[b]=-z;b-=2,I=0}else{if(c=s.get(b,b),m=0,f=0,h<b&&(m=s.get(b-1,b-1),f=s.get(b,b-1)*s.get(b-1,b)),10===I){for(S+=c,i=0;i<=b;i++)s.set(i,i,s.get(i,i)-c);c=m=.75*(A=Math.abs(s.get(b,b-1))+Math.abs(s.get(b-1,b-2))),f=-.4375*A*A}if(30===I&&(A=(A=(m-c)/2)*A+f)>0){for(A=Math.sqrt(A),m<c&&(A=-A),A=c-f/((m-c)/2+A),i=0;i<=b;i++)s.set(i,i,s.get(i,i)-A);S+=A,c=m=f=.964}for(I+=1,l=b-2;l>=h&&(k=c-(z=s.get(l,l)),R=(k*(A=m-z)-f)/s.get(l+1,l)+s.get(l,l+1),N=s.get(l+1,l+1)-z-k-A,A=Math.abs(R)+Math.abs(N)+Math.abs(k=s.get(l+2,l+1)),R/=A,N/=A,k/=A,!(l===h||Math.abs(s.get(l,l-1))*(Math.abs(N)+Math.abs(k))<x*(Math.abs(R)*(Math.abs(s.get(l-1,l-1))+Math.abs(z)+Math.abs(s.get(l+1,l+1))))));){;l--}for(i=l+2;i<=b;i++)s.set(i,i-2,0),i>l+2&&s.set(i,i-3,0);for(a=l;a<=b-1&&(y=a!==b-1,a!==l&&(R=s.get(a,a-1),N=s.get(a+1,a-1),0!==(c=Math.abs(R)+Math.abs(N)+Math.abs(k=y?s.get(a+2,a-1):0))&&(R/=c,N/=c,k/=c)),0!==c);a++){;if(A=Math.sqrt(R*R+N*N+k*k),R<0&&(A=-A),0!==A){for(a!==l?s.set(a,a-1,-A*c):h!==l&&s.set(a,a-1,-s.get(a,a-1)),R+=A,c=R/A,m=N/A,z=k/A,N/=R,k/=R,n=a;n<t;n++)R=s.get(a,n)+N*s.get(a+1,n),y&&(R+=k*s.get(a+2,n),s.set(a+2,n,s.get(a+2,n)-R*z)),s.set(a,n,s.get(a,n)-R*c),s.set(a+1,n,s.get(a+1,n)-R*m);for(i=0;i<=Math.min(b,a+3);i++)R=c*s.get(i,a)+m*s.get(i,a+1),y&&(R+=z*s.get(i,a+2),s.set(i,a+2,s.get(i,a+2)-R*k)),s.set(i,a,s.get(i,a)-R),s.set(i,a+1,s.get(i,a+1)-R*N);for(i=0;i<=M;i++)R=c*o.get(i,a)+m*o.get(i,a+1),y&&(R+=z*o.get(i,a+2),o.set(i,a+2,o.get(i,a+2)-R*k)),o.set(i,a,o.get(i,a)-R),o.set(i,a+1,o.get(i,a+1)-R*N)}}}}if(0!==E){for(b=t-1;b>=0;b--)if(R=r[b],0===(N=e[b]))for(h=b,s.set(b,b,1),i=b-1;i>=0;i--){for(f=s.get(i,i)-R,k=0,n=h;n<=b;n++)k+=s.get(i,n)*s.get(n,b);if(e[i]<0)z=f,A=k;else if(h=i,0===e[i]?s.set(i,b,0!==f?-k/f:-k/(x*E)):(c=s.get(i,i+1),m=s.get(i+1,i),u=(c*A-z*k)/(N=(r[i]-R)*(r[i]-R)+e[i]*e[i]),s.set(i,b,u),s.set(i+1,b,Math.abs(c)>Math.abs(z)?(-k-f*u)/c:(-A-m*u)/z)),x*(u=Math.abs(s.get(i,b)))*u>1)for(n=i;n<=b;n++)s.set(n,b,s.get(n,b)/u)}else if(N<0)for(h=b-1,Math.abs(s.get(b,b-1))>Math.abs(s.get(b-1,b))?(s.set(b-1,b-1,N/s.get(b,b-1)),s.set(b-1,b,-(s.get(b,b)-R)/s.get(b,b-1))):(v=P(0,-s.get(b-1,b),s.get(b-1,b-1)-R,N),s.set(b-1,b-1,v[0]),s.set(b-1,b,v[1])),s.set(b,b-1,0),s.set(b,b,1),i=b-2;i>=0;i--){for(g=0,p=0,n=h;n<=b;n++)g+=s.get(i,n)*s.get(n,b-1),p+=s.get(i,n)*s.get(n,b);if(f=s.get(i,i)-R,e[i]<0)z=f,k=g,A=p;else if(h=i,0===e[i]?(v=P(-g,-p,f,N),s.set(i,b-1,v[0]),s.set(i,b,v[1])):(c=s.get(i,i+1),m=s.get(i+1,i),d=(r[i]-R)*(r[i]-R)+e[i]*e[i]-N*N,w=(r[i]-R)*2*N,0===d&&0===w&&(d=x*E*(Math.abs(f)+Math.abs(N)+Math.abs(c)+Math.abs(m)+Math.abs(z))),v=P(c*k-z*g+N*p,c*A-z*p-N*g,d,w),s.set(i,b-1,v[0]),s.set(i,b,v[1]),Math.abs(c)>Math.abs(z)+Math.abs(N)?(s.set(i+1,b-1,(-g-f*s.get(i,b-1)+N*s.get(i,b))/c),s.set(i+1,b,(-p-f*s.get(i,b)-N*s.get(i,b-1))/c)):(v=P(-k-m*s.get(i,b-1),-A-m*s.get(i,b),z,N),s.set(i+1,b-1,v[0]),s.set(i+1,b,v[1]))),x*(u=Math.max(Math.abs(s.get(i,b-1)),Math.abs(s.get(i,b))))*u>1)for(n=i;n<=b;n++)s.set(n,b-1,s.get(n,b-1)/u),s.set(n,b,s.get(n,b)/u)}for(i=0;i<t;i++)if(i<0||i>M)for(n=i;n<t;n++)o.set(i,n,s.get(i,n));for(n=t-1;n>=0;n--)for(i=0;i<=M;i++){for(a=0,z=0;a<=Math.min(n,M);a++)z+=o.get(i,a)*s.get(a,n);o.set(i,n,z)}}}(i,h,a,n,t)}this.n=i,this.e=h,this.d=a,this.V=n}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,o=this.e,s=this.d,i=new S(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)i.set(t,e,0);i.set(t,t,s[t]),o[t]>0?i.set(t,t+1,o[t]):o[t]<0&&i.set(t,t-1,o[t])}return i}}function P(t,e,r,o){let s,i;return Math.abs(r)>Math.abs(o)?(s=o/r,i=r+s*o,[(t+s*e)/i,(e-s*t)/i]):(s=r/o,i=o+s*r,[(s*t+e)/i,(s*e-t)/i])}class D{constructor(t){let e,r,o;if(!(t=z.checkMatrix(t)).isSymmetric())throw Error("Matrix is not symmetric");let s=t,i=s.rows,n=new S(i,i),a=!0;for(r=0;r<i;r++){let t=0;for(o=0;o<r;o++){let i=0;for(e=0;e<o;e++)i+=n.get(o,e)*n.get(r,e);i=(s.get(r,o)-i)/n.get(o,o),n.set(r,o,i),t+=i*i}for(a&=(t=s.get(r,r)-t)>0,n.set(r,r,Math.sqrt(Math.max(t,0))),o=r+1;o<i;o++)n.set(r,o,0)}this.L=n,this.positiveDefinite=!!a}isPositiveDefinite(){return this.positiveDefinite}solve(t){let e,r,o;t=z.checkMatrix(t);let s=this.L,i=s.rows;if(t.rows!==i)throw Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw Error("Matrix is not positive definite");let n=t.columns,a=t.clone();for(o=0;o<i;o++)for(r=0;r<n;r++){for(e=0;e<o;e++)a.set(o,r,a.get(o,r)-a.get(e,r)*s.get(o,e));a.set(o,r,a.get(o,r)/s.get(o,o))}for(o=i-1;o>=0;o--)for(r=0;r<n;r++){for(e=o+1;e<i;e++)a.set(o,r,a.get(o,r)-a.get(e,r)*s.get(e,o));a.set(o,r,a.get(o,r)/s.get(o,o))}return a}get lowerTriangularMatrix(){return this.L}}class q{constructor(t,e={}){let r,o,s,n,a;t=z.checkMatrix(t);let{Y:h}=e,{scaleScores:l=!1,maxIterations:u=1e3,terminationCriteria:f=1e-10}=e;if(h){if((h=i.isAnyArray(h)&&"number"==typeof h[0]?S.columnVector(h):z.checkMatrix(h)).rows!==t.rows)throw Error("Y should have the same number of rows as X");r=h.getColumnVector(0)}else r=t.getColumnVector(0);let c=1;for(let e=0;e<u&&c>f;e++)n=(n=t.transpose().mmul(r).div(r.transpose().mmul(r).get(0,0))).div(n.norm()),o=t.mmul(n).div(n.transpose().mmul(n).get(0,0)),e>0&&(c=o.clone().sub(a).pow(2).sum()),a=o.clone(),h?(s=(s=h.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0))).div(s.norm()),r=h.mmul(s).div(s.transpose().mmul(s).get(0,0))):r=o;if(h){let e=t.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0));e=e.div(e.norm());let i=t.clone().sub(o.clone().mmul(e.transpose())),a=r.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0)),l=h.clone().sub(o.clone().mulS(a.get(0,0)).mmul(s.transpose()));this.t=o,this.p=e.transpose(),this.w=n.transpose(),this.q=s,this.u=r,this.s=o.transpose().mmul(o),this.xResidual=i,this.yResidual=l,this.betas=a}else this.w=n.transpose(),this.s=o.transpose().mmul(o).sqrt(),l?this.t=o.clone().div(this.s.get(0,0)):this.t=o,this.xResidual=t.sub(o.mmul(n.transpose()))}}e.AbstractMatrix=M,e.CHO=D,e.CholeskyDecomposition=D,e.DistanceMatrix=R,e.EVD=F,e.EigenvalueDecomposition=F,e.LU=I,e.LuDecomposition=I,e.Matrix=S,e.MatrixColumnSelectionView=class t extends N{constructor(t,e){d(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.MatrixColumnView=class t extends N{constructor(t,e){c(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}},e.MatrixFlipColumnView=class t extends N{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.MatrixFlipRowView=class t extends N{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.MatrixRowSelectionView=class t extends N{constructor(t,e){p(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.MatrixRowView=class t extends N{constructor(t,e){f(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}},e.MatrixSelectionView=k,e.MatrixSubView=class t extends N{constructor(t,e,r,o,s){w(t,e,r,o,s),super(t,r-e+1,s-o+1),this.startRow=e,this.startColumn=o}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.MatrixTransposeView=class t extends N{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}},e.NIPALS=q,e.Nipals=q,e.QR=T,e.QrDecomposition=T,e.SVD=V,e.SingularValueDecomposition=V,e.SymmetricMatrix=E,e.WrapperMatrix1D=A,e.WrapperMatrix2D=z,e.correlation=function(t,e=t,r={}){t=new S(t);let o=!1;if("object"!=typeof e||S.isMatrix(e)||i.isAnyArray(e)?e=new S(e):(r=e,e=t,o=!0),t.rows!==e.rows)throw TypeError("Both matrices must have the same number of rows");let{center:s=!0,scale:n=!0}=r;s&&(t.center("column"),!o&&e.center("column")),n&&(t.scale("column"),!o&&e.scale("column"));let a=t.standardDeviation("column",{unbiased:!0}),h=o?a:e.standardDeviation("column",{unbiased:!0}),l=t.transpose().mmul(e);for(let e=0;e<l.rows;e++)for(let r=0;r<l.columns;r++)l.set(e,r,l.get(e,r)*(1/(a[e]*h[r]))*(1/(t.rows-1)));return l},e.covariance=function(t,e=t,r={}){t=new S(t);let o=!1;if("object"!=typeof e||S.isMatrix(e)||i.isAnyArray(e)?e=new S(e):(r=e,e=t,o=!0),t.rows!==e.rows)throw TypeError("Both matrices must have the same number of rows");let{center:s=!0}=r;s&&(t=t.center("column"),!o&&(e=e.center("column")));let n=t.transpose().mmul(e);for(let e=0;e<n.rows;e++)for(let r=0;r<n.columns;r++)n.set(e,r,n.get(e,r)*(1/(t.rows-1)));return n},e.default=S,e.determinant=function t(e){if((e=S.checkMatrix(e)).isSquare()){let r,o,s;if(0===e.columns)return 1;if(2===e.columns)return r=e.get(0,0),o=e.get(0,1),s=e.get(1,0),r*e.get(1,1)-o*s;if(3!==e.columns)return new I(e).determinant;else{let i,n,a;return i=new k(e,[1,2],[1,2]),n=new k(e,[1,2],[0,2]),a=new k(e,[1,2],[0,1]),r=e.get(0,0),o=e.get(0,1),s=e.get(0,2),r*t(i)-o*t(n)+s*t(a)}}throw Error("determinant can only be calculated for a square matrix")},e.inverse=function(t,e=!1){return(t=z.checkMatrix(t),e)?new V(t).inverse():_(t,S.eye(t.rows))},e.linearDependencies=function(t,e={}){let{thresholdValue:r=1e-9,thresholdError:o=1e-9}=e,s=(t=S.checkMatrix(t)).rows,i=new S(s,s);for(let e=0;e<s;e++){let n=S.columnVector(t.getRow(e)),a=t.subMatrixRow(function(t,e){let r=[];for(let o=0;o<t;o++)o!==e&&r.push(o);return r}(s,e)).transpose(),h=new V(a).solve(n),l=S.sub(n,a.mmul(h)).abs().max();i.setRow(e,function(t,e,r,o=1e-9,s=1e-9){if(t>s)return Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<o&&t.set(e,0,0);return t.to1DArray()}}(l,h,e,r,o))}return i},e.pseudoInverse=function(t,e=Number.EPSILON){if((t=S.checkMatrix(t)).isEmpty())return t.transpose();let r=new V(t,{autoTranspose:!0}),o=r.leftSingularVectors,s=r.rightSingularVectors,i=r.diagonal;for(let t=0;t<i.length;t++)Math.abs(i[t])>e?i[t]=1/i[t]:i[t]=0;return s.mmul(S.diag(i).mmul(o.transpose()))},e.solve=_,e.wrap=function(t,e){if(i.isAnyArray(t))return t[0]&&i.isAnyArray(t[0])?new z(t):new A(t,e);throw Error("the argument is not an array")}},235390:function(t,e,r){"use strict";var o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var s=o(r("32519"));function i(t,e){var r=function(r){return s.empty(t).map(function(){return s.filled(e,r)})},o=[];return o.push(r(-1)),o.push(r(1/0)),o.push(r(0)),o}e.makeHeap=i;function n(t,e,r,o,s){e=Math.floor(e);var i=t[0][e],n=t[1][e];if(t[2][e],r>=n[0])return 0;for(var h=0;h<i.length;h++)if(o===i[h])return 0;return a(t,e,r,o,s)}function a(t,e,r,o,s){var i=t[0][e],n=t[1][e],a=t[2][e];if(r>=n[0])return 0;n[0]=r,i[0]=o,a[0]=s;for(var h=0,l=0;;){var u=2*h+1,f=u+1,c=t[0][0].length;if(u>=c)break;if(f>=c){if(n[u]>r)l=u;else break}else if(n[u]>=n[f]){if(r<n[u])l=u;else break}else if(r<n[f])l=f;else break;n[h]=n[l],i[h]=i[l],a[h]=a[l],h=l}return n[h]=r,i[h]=o,a[h]=s,1}e.rejectionSample=function(t,e,r){for(var o=s.zeros(t),i=0;i<t;i++){for(var n=!0,a=0;n;){a=s.tauRandInt(e,r);for(var h=!1,l=0;l<i;l++)if(a===o[l]){h=!0;break}!h&&(n=!1)}o[i]=a}return o},e.heapPush=n,e.uncheckedHeapPush=a;e.buildCandidates=function(t,e,r,o,a){for(var h=i(e,o),l=0;l<e;l++)for(var u=0;u<r;u++)if(!(t[0][l][u]<0)){var f=t[0][l][u],c=t[2][l][u],m=s.tauRand(a);n(h,l,m,f,c),n(h,f,m,l,c),t[2][l][u]=0}return h};e.deheapSort=function(t){for(var e=t[0],r=t[1],o=0;o<e.length;o++){for(var s=e[o],i=r[o],n=0;n<s.length-1;n++){var a=s.length-n-1,h=i.length-n-1,l=s[0];s[0]=s[a],s[a]=l;var u=i[0];i[0]=i[h],i[h]=u,function(t,e,r,o){for(;2*o+1<r;){var s=2*o+1,i=s+1,n=o;if(t[n]<t[s]&&(n=s),i<r&&t[n]<t[i]&&(n=i),n===o)break;var a=t[o];t[o]=t[n],t[n]=a;var h=e[o];e[o]=e[n],e[n]=h,o=n}}(i,s,h,0)}}return{indices:e,weights:r}};e.smallestFlagged=function(t,e){for(var r=t[0][e],o=t[1][e],s=t[2][e],i=1/0,n=-1,a=0;a>r.length;a++)1===s[a]&&o[a]<i&&(i=o[a],n=a);return n>=0?(s[n]=0,Math.floor(r[n])):-1}},507566:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r("183232");e.UMAP=o.UMAP},993064:function(t,e,r){"use strict";var o,s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,s,i=r.call(t),n=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)n.push(o.value)}catch(t){s={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return n},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a=n(r("32519")),h=function(){function t(t,e,r,o){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw Error("rows, cols and values arrays must all have the same length");this.nRows=o[0],this.nCols=o[1];for(var s=0;s<r.length;s++){var i=t[s],n=e[s];this.checkDims(i,n);var a=this.makeKey(i,n);this.entries.set(a,{value:r[s],row:i,col:n})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var o=this.makeKey(t,e);this.entries.has(o)?this.entries.get(o).value=r:this.entries.set(o,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var o=this.makeKey(t,e);return this.entries.has(o)?this.entries.get(o).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach(function(t){e.push(t)}),t&&e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,function(t){var e=s(t,2);return(e[0],e[1]).row})},t.prototype.getCols=function(){return Array.from(this.entries,function(t){var e=s(t,2);return(e[0],e[1]).col})},t.prototype.getValues=function(){return Array.from(this.entries,function(t){var e=s(t,2);return(e[0],e[1]).value})},t.prototype.forEach=function(t){this.entries.forEach(function(e){return t(e.value,e.row,e.col)})},t.prototype.map=function(e){var r=[];this.entries.forEach(function(t){r.push(e(t.value,t.row,t.col))});var o=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,o)},t.prototype.toArray=function(){var t=this,e=a.empty(this.nRows).map(function(){return a.zeros(t.nCols)});return this.entries.forEach(function(t){e[t.row][t.col]=t.value}),e},t}();e.SparseMatrix=h;e.transpose=function(t){var e=[],r=[],o=[];return t.forEach(function(t,s,i){e.push(s),r.push(i),o.push(t)}),new h(r,e,o,[t.nCols,t.nRows])};e.identity=function(t){for(var e=s(t,1)[0],r=new h([],[],[],t),o=0;o<e;o++)r.set(o,o,1);return r};e.pairwiseMultiply=function(t,e){return u(t,e,function(t,e){return t*e})};e.add=function(t,e){return u(t,e,function(t,e){return t+e})};e.subtract=function(t,e){return u(t,e,function(t,e){return t-e})};e.maximum=function(t,e){return u(t,e,function(t,e){return t>e?t:e})};e.multiplyScalar=function(t,e){return t.map(function(t){return t*e})};e.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),o=t.getRows(),s=t.getCols(),i=0;i<r.length;i++)0===r[i]&&e.add(i);var n=function(t,r){return!e.has(r)},a=r.filter(n);return new h(o.filter(n),s.filter(n),a,t.getDims())};e.normalize=function(t,e){void 0===e&&(e="l2");var r,o,s=l[e],n=new Map;t.forEach(function(t,e,r){var o=n.get(e)||[];o.push(r),n.set(e,o)});var a=new h([],[],[],t.getDims()),u=function(e){for(var r=n.get(e).sort(),o=s(r.map(function(r){return t.get(e,r)})),i=0;i<o.length;i++)a.set(e,r[i],o[i])};try{for(var f=i(n.keys()),c=f.next();!c.done;c=f.next()){var m=c.value;u(m)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}return a};var l=((o={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map(function(t){return t/e})},o.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map(function(t){return t/e})},o.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map(function(t){return Math.sqrt(Math.pow(t,2)/e)})},o);function u(t,e,r){for(var o=new Set,s=[],i=[],n=[],a=function(o,a){s.push(o),i.push(a);var h=r(t.get(o,a),e.get(o,a));n.push(h)},l=t.getValues(),u=t.getRows(),f=t.getCols(),c=0;c<l.length;c++){var m=u[c],g=f[c],p=m+":"+g;o.add(p),a(m,g)}for(var d=e.getValues(),w=e.getRows(),y=e.getCols(),c=0;c<d.length;c++){var m=w[c],g=y[c],p=m+":"+g;!o.has(p)&&a(m,g)}return new h(s,i,n,[t.nRows,t.nCols])}e.getCSR=function(t){var e=[];t.forEach(function(t,r,o){e.push({value:t,row:r,col:o})}),e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row});for(var r=[],o=[],s=[],i=-1,n=0;n<e.length;n++){var a=e[n],h=a.row,l=a.col,u=a.value;h!==i&&(i=h,s.push(n)),r.push(l),o.push(u)}return{indices:r,values:o,indptr:s}}},268552:function(t,e,r){"use strict";var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=s(r("235390")),n=s(r("993064")),a=s(r("139108")),h=s(r("32519"));e.makeNNDescent=function(t,e){return function(r,o,s,n,a,l,u,f){void 0===n&&(n=10),void 0===a&&(a=50),void 0===l&&(l=.001),void 0===u&&(u=.5),void 0===f&&(f=!0);for(var c=r.length,m=i.makeHeap(r.length,s),g=0;g<r.length;g++){for(var p=i.rejectionSample(s,r.length,e),d=0;d<p.length;d++){var w=t(r[g],r[p[d]]);i.heapPush(m,g,w,p[d],1),i.heapPush(m,p[d],w,g,1)}}if(f)for(var y=0;y<o.length;y++)for(var g=0;g<o[y].length&&!(o[y][g]<0);g++)for(var d=g+1;d<o[y].length&&!(o[y][d]<0);d++){var w=t(r[o[y][g]],r[o[y][d]]);i.heapPush(m,o[y][g],w,o[y][d],1),i.heapPush(m,o[y][d],w,o[y][g],1)}for(var y=0;y<n;y++){for(var v=i.buildCandidates(m,c,s,a,e),b=0,g=0;g<c;g++)for(var d=0;d<a;d++){var M=Math.floor(v[0][g][d]);if(!(M<0||h.tauRand(e)<u))for(var x=0;x<a;x++){var S=Math.floor(v[0][g][x]),E=v[2][g][d],R=v[2][g][x];if(!(S<0)&&(E||R)){var w=t(r[M],r[S]);b+=i.heapPush(m,M,w,S,1)+i.heapPush(m,S,w,M,1)}}}if(b<=l*s*r.length)break}return i.deheapSort(m)}};e.makeInitializations=function(t){return{initFromRandom:function(e,r,o,s,n){for(var a=0;a<o.length;a++){for(var l=h.rejectionSample(e,r.length,n),u=0;u<l.length;u++)if(!(l[u]<0)){var f=t(r[l[u]],o[a]);i.heapPush(s,a,f,l[u],1)}}},initFromTree:function(e,r,o,s,n){for(var h=0;h<o.length;h++){for(var l=a.searchFlatTree(o[h],e,n),u=0;u<l.length;u++){if(l[u]<0)return;var f=t(r[l[u]],o[h]);i.heapPush(s,h,f,l[u],1)}}}}};e.makeInitializedNNSearch=function(t){return function(e,r,s,a){for(var h,l,u=n.getCSR(r),f=u.indices,c=u.indptr,m=0;m<a.length;m++){for(var g=new Set(s[0][m]);;){var p=i.smallestFlagged(s,m);if(-1===p)break;var d=f.slice(c[p],c[p+1]);try{for(var w=o(d),y=w.next();!y.done;y=w.next()){var v=y.value;if(!(v===p||-1===v||g.has(v))){var b=t(e[v],a[m]);i.uncheckedHeapPush(s,m,b,v,1),g.add(v)}}}catch(t){h={error:t}}finally{try{y&&!y.done&&(l=w.return)&&l.call(w)}finally{if(h)throw h.error}}}}return s}};e.initializeSearch=function(t,e,r,s,n,a,h){var l,u,f=i.makeHeap(r.length,s);if(n(s,e,r,f,h),t)try{for(var c=o(t),m=c.next();!m.done;m=c.next()){var g=m.value;a(g,e,r,f,h)}}catch(t){l={error:t}}finally{try{m&&!m.done&&(u=c.return)&&u.call(c)}finally{if(l)throw l.error}}return f}},139108:function(t,e,r){"use strict";var o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,s,i=r.call(t),n=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)n.push(o.value)}catch(t){s={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return n},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a=n(r("32519")),h=function(t,e,r,o){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=o};e.FlatTree=h;e.makeForest=function(t,e,r,o){var i=Math.max(10,e);return a.range(r).map(function(e,r){return function(t,e,r,o){void 0===e&&(e=30);var s=a.range(t.length);return function t(e,r,o,s,i){if(void 0===o&&(o=30),r.length>o){var n=function(t,e,r){var o=t[0].length,s=a.tauRandInt(e.length,r),i=a.tauRandInt(e.length,r);i+=s===i?1:0,i%=e.length;for(var n=e[s],h=e[i],l=0,u=a.zeros(o),f=0;f<u.length;f++)u[f]=t[n][f]-t[h][f],l-=u[f]*(t[n][f]+t[h][f])/2;for(var c=0,m=0,g=a.zeros(e.length),f=0;f<e.length;f++){for(var p=l,d=0;d<o;d++)p+=u[d]*t[e[f]][d];0===p?(g[f]=a.tauRandInt(2,r),0===g[f]?c+=1:m+=1):p>0?(g[f]=0,c+=1):(g[f]=1,m+=1)}var w=a.zeros(c),y=a.zeros(m);c=0,m=0;for(var f=0;f<g.length;f++)0===g[f]?(w[c]=e[f],c+=1):(y[m]=e[f],m+=1);return{indicesLeft:w,indicesRight:y,hyperplane:u,offset:l}}(e,r,i),h=n.indicesLeft,l=n.indicesRight,u=n.hyperplane,f=n.offset,c={leftChild:t(e,h,o,s+1,i),rightChild:t(e,l,o,s+1,i),isLeaf:!1,hyperplane:u,offset:f};return c}var c={indices:r,isLeaf:!0};return c}(t,s,e,r,o)}(t,i,r,o)}).map(function(t){return function(t,e){var r=function t(e){return e.isLeaf?1:1+t(e.leftChild)+t(e.rightChild)}(t),o=function t(e){return e.isLeaf?1:t(e.leftChild)+t(e.rightChild)}(t),i=a.range(r).map(function(){return a.zeros(t.hyperplane?t.hyperplane.length:0)}),n=a.zeros(r),l=a.range(r).map(function(){return[-1,-1]}),u=a.range(o).map(function(){return a.range(e).map(function(){return -1})});return function t(e,r,o,i,n,a,h){if(e.isLeaf)return i[a][0]=-h,(l=n[h]).splice.apply(l,s([0,e.indices.length],e.indices)),{nodeNum:a,leafNum:h+=1};r[a]=e.hyperplane,o[a]=e.offset,i[a][0]=a+1;var l,u=a,f=t(e.leftChild,r,o,i,n,a+1,h);return a=f.nodeNum,h=f.leafNum,i[u][1]=a+1,{nodeNum:(f=t(e.rightChild,r,o,i,n,a+1,h)).nodeNum,leafNum:f.leafNum}}(t,i,n,l,u,0,0),new h(i,n,l,u)}(t,i)})};e.makeLeafArray=function(t){if(!(t.length>0))return[[-1]];var e,r,o=[];try{for(var n=i(t),a=n.next();!a.done;a=n.next()){var h=a.value;o.push.apply(o,s(h.indices))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o};e.searchFlatTree=function(t,e,r){for(var o=0;e.children[o][0]>0;)o=0===function(t,e,r,o){for(var s=e,i=0;i<r.length;i++)s+=t[i]*r[i];return 0===s?a.tauRandInt(2,o):s>0?0:1}(e.hyperplanes[o],e.offsets[o],t,r)?e.children[o][0]:e.children[o][1];var s=-1*e.children[o][0];return e.indices[s]}},183232:function(t,e,r){"use strict";var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(s,i){function n(t){try{h(o.next(t))}catch(t){i(t)}}function a(t){try{h(o.throw(t))}catch(t){i(t)}}function h(t){t.done?s(t.value):new r(function(e){e(t.value)}).then(n,a)}h((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var r,o,s,i,n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return n.label++,{value:i[1],done:!1};case 5:n.label++,o=i[1],i=[0];continue;case 7:i=n.ops.pop(),n.trys.pop();continue;default:if(!(s=(s=n.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){n=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){n.label=i[1];break}if(6===i[0]&&n.label<s[1]){n.label=s[1],s=i;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(i);break}s[2]&&n.ops.pop(),n.trys.pop();continue}i=e.call(t,n)}catch(t){i=[6,t],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,s,i=r.call(t),n=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)n.push(o.value)}catch(t){s={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return n},n=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},h=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var l=a(r("235390")),u=a(r("993064")),f=a(r("268552")),c=a(r("139108")),m=a(r("32519")),g=h(r("528890")),p=function(){function t(t){void 0===t&&(t={});var e=this;this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=d,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new w;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("distanceFn"),r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread"),r("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),o(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}})})},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),o=r.head,s=r.tail,i=r.epochsPerSample;return this.optimizationState.head=o,this.optimizationState.tail=s,this.optimizationState.epochsPerSample=i,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=f.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=f.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,o=[t.length,t.length],s=new u.SparseMatrix([],[],[],o),i=0;i<e.length;i++){for(var n=e[i],a=r[i],h=0;h<n.length;h++){var l=n[h],f=a[h];f>0&&s.set(i,l,f)}}var c=u.transpose(s);return u.maximum(s,c)},t.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw Error("No data has been fit.");var o=Math.floor(this.nNeighbors*this.transformQueueSize);o=Math.min(r.length,o);var s=f.initializeSearch(this.rpForest,r,t,o,this.initFromRandom,this.initFromTree,this.random),i=this.search(r,this.searchGraph,s,t),n=l.deheapSort(i),a=n.indices,h=n.weights;a=a.map(function(t){return t.slice(0,e.nNeighbors)}),h=h.map(function(t){return t.slice(0,e.nNeighbors)});var c=Math.max(0,this.localConnectivity-1),g=this.smoothKNNDistance(h,this.nNeighbors,c),p=g.sigmas,d=g.rhos,w=this.computeMembershipStrengths(a,h,p,d),y=w.rows,v=w.cols,b=w.vals,M=[t.length,r.length],x=new u.SparseMatrix(y,v,b,M),E=u.normalize(x,"l1"),R=u.getCSR(E),N=t.length,k=S(m.reshape2d(R.indices,N,this.nNeighbors),m.reshape2d(R.values,N,this.nNeighbors),this.embedding),A=this.nEpochs?this.nEpochs/3:x.nRows<=1e4?100:30,z=x.getValues().reduce(function(t,e){return e>t?e:t},0);x=x.map(function(t){return t<z/A?0:t}),x=u.eliminateZeros(x);var I=this.makeEpochsPerSample(x.getValues(),A),C=x.getRows(),T=x.getCols();return this.assignOptimizationStateParameters({headEmbedding:k,tailEmbedding:this.embedding,head:C,tail:T,currentEpoch:0,nEpochs:A,nVertices:x.getDims()[1],epochsPerSample:I}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?2.5*(1/(1-this.targetWeight)):1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e,r=this.distanceFn,o=this.nNeighbors,s=f.makeNNDescent(r,this.random);var i=5+Math.floor(.5==(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),n=Math.max(5,Math.floor(Math.round(Math.log(t.length)/Math.log(2))));this.rpForest=c.makeForest(t,o,i,this.random);var a=s(t,c.makeLeafArray(this.rpForest),o,n);return{knnIndices:a.indices,knnDistances:a.weights}},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var o=this.knnIndices,s=this.knnDistances,i=void 0===s?[]:s,n=this.localConnectivity,a=this.smoothKNNDistance(i,e,n),h=a.sigmas,l=a.rhos,f=this.computeMembershipStrengths(void 0===o?[]:o,i,h,l),c=f.rows,m=f.cols,g=f.vals,p=[t.length,t.length],d=new u.SparseMatrix(c,m,g,p),w=u.transpose(d),y=u.pairwiseMultiply(d,w),v=u.subtract(u.add(d,w),y),b=u.multiplyScalar(v,r),M=u.multiplyScalar(y,1-r);return u.add(b,M)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,r,o){void 0===o&&(o=1);var s=M(t,e,o,r);return x(s=u.eliminateZeros(s))},t.prototype.smoothKNNDistance=function(t,e,r,o,s){void 0===r&&(r=1),void 0===o&&(o=64),void 0===s&&(s=1);for(var i=Math.log(e)/Math.log(2)*s,n=m.zeros(t.length),a=m.zeros(t.length),h=0;h<t.length;h++){var l=0,u=1/0,f=1,c=t[h],g=c.filter(function(t){return t>0});if(g.length>=r){var p=Math.floor(r),d=r-p;p>0?(n[h]=g[p-1],d>1e-5&&(n[h]+=d*(g[p]-g[p-1]))):n[h]=d*g[0]}else g.length>0&&(n[h]=m.max(g));for(var w=0;w<o;w++){for(var y=0,v=1;v<t[h].length;v++){var b=t[h][v]-n[h];b>0?y+=Math.exp(-(b/f)):y+=1}if(1e-5>Math.abs(y-i))break;y>i?f=(l+(u=f))/2:(l=f,u===1/0?f*=2:f=(l+u)/2)}if(a[h]=f,n[h]>0){var M=m.mean(c);a[h]<.001*M&&(a[h]=.001*M)}else{var x=m.mean(t.map(m.mean));a[h]<.001*x&&(a[h]=.001*x)}}return{sigmas:a,rhos:n}},t.prototype.computeMembershipStrengths=function(t,e,r,o){for(var s=t.length,i=t[0].length,n=m.zeros(s*i),a=m.zeros(s*i),h=m.zeros(s*i),l=0;l<s;l++)for(var u=0;u<i;u++){var f=0;-1!==t[l][u]&&(f=t[l][u]===l?0:e[l][u]-o[l]<=0?1:Math.exp(-((e[l][u]-o[l])/r[l])),n[l*i+u]=l,a[l*i+u]=t[l][u],h[l*i+u]=f)}return{rows:n,cols:a,vals:h}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,o=this.graph.getValues(),s=0,i=0;i<o.length;i++){var n=o[i];s<o[i]&&(s=n)}var a=this.graph.map(function(t){return t<s/e?0:t});this.embedding=m.zeros(a.nRows).map(function(){return m.zeros(r).map(function(){return 20*m.tauRand(t.random)+-10})});for(var h=[],l=[],u=[],f=a.getAll(),i=0;i<f.length;i++){var c=f[i];c.value&&(h.push(c.value),u.push(c.row),l.push(c.col))}return{head:l,tail:u,epochsPerSample:this.makeEpochsPerSample(h,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=m.filled(t.length,-1),o=m.max(t),s=t.map(function(t){return t/o*e});return s.forEach(function(t,o){t>0&&(r[o]=e/s[o])}),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this.repulsionStrength,e=this.learningRate,r=this.negativeSampleRate,o=this.optimizationState,s=o.epochsPerSample,i=o.headEmbedding,a=o.tailEmbedding,h=i[0].length,l=i.length===a.length,u=s.map(function(t){return t/r}),f=n(u),c=n(s);this.assignOptimizationStateParameters({epochOfNextSample:c,epochOfNextNegativeSample:f,epochsPerNegativeSample:u,moveOther:l,initialAlpha:e,alpha:e,gamma:t,dim:h})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,o=r.head,s=r.tail,i=r.epochsPerSample,n=this.getNEpochs(),a=this.graph.nCols,h=b(this.spread,this.minDist),l=h.a,u=h.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:o,tail:s,epochsPerSample:i,a:l,b:u,nEpochs:n,nVertices:a})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,o=e.tail,s=e.headEmbedding,i=e.tailEmbedding,n=e.epochsPerSample,a=e.epochOfNextSample,h=e.epochOfNextNegativeSample,l=e.epochsPerNegativeSample,u=e.moveOther,f=e.initialAlpha,c=e.alpha,g=e.gamma,p=e.a,d=e.b,w=e.dim,b=e.nEpochs,M=e.nVertices,x=0;x<n.length;x++)if(!(a[x]>t)){var S=r[x],E=o[x],R=s[S],N=i[E],k=v(R,N),A=0;k>0&&(A=-2*p*d*Math.pow(k,d-1)/(p*Math.pow(k,d)+1));for(var z=0;z<w;z++){var I=y(A*(R[z]-N[z]),4);R[z]+=I*c,u&&(N[z]+=-I*c)}a[x]+=n[x];for(var C=Math.floor((t-h[x])/l[x]),T=0;T<C;T++){var V=m.tauRandInt(M,this.random),_=i[V],F=v(R,_),P=0;if(F>0)P=2*g*d/((.001+F)*(p*Math.pow(F,d)+1));else if(S===V)continue;for(var z=0;z<w;z++){var I=4;P>0&&(I=y(P*(R[z]-_[z]),4)),R[z]+=I*c}}h[x]+=C*l[x]}return e.alpha=f*(1-t/b),e.currentEpoch+=1,s},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise(function(r,i){var n=function(){return o(e,void 0,void 0,function(){var e,o,a,h,l,u;return s(this,function(s){try{if(o=(e=this.optimizationState).nEpochs,a=e.currentEpoch,this.embedding=this.optimizeLayoutStep(a),h=this.optimizationState.currentEpoch,l=!1===t(h),u=h===o,l||u)return[2,r(u)];setTimeout(function(){return n()},0)}catch(t){i(t)}return[2]})})};setTimeout(function(){return n()},0)})},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var o=this.optimizationState,s=o.nEpochs,i=o.currentEpoch;r=this.optimizeLayoutStep(i);var n=this.optimizationState.currentEpoch,a=!1===t(n);e=n===s||a}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;if(e<=2500)return 500;if(e<=5e3)return 400;if(e<=7500)return 300;else return 200},t}();function d(t,e){for(var r=0,o=0;o<t.length;o++)r+=Math.pow(t[o]-e[o],2);return Math.sqrt(r)}e.UMAP=p,e.euclidean=d;e.cosine=function(t,e){for(var r=0,o=0,s=0,i=0;i<t.length;i++)r+=t[i]*e[i],o+=Math.pow(t[i],2),s+=Math.pow(e[i],2);return 0===o&&0===s?0:0===o||0===s?1:1-r/Math.sqrt(o*s)};var w=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function y(t,e){return t>e?e:t<-e?-e:t}function v(t,e){for(var r=0,o=0;o<t.length;o++)r+=Math.pow(t[o]-e[o],2);return r}function b(t,e){var r=m.linear(0,3*t,300).map(function(t){return t<e?1:t}),o=m.zeros(r.length).map(function(o,s){return r[s]>=e?Math.exp(-(r[s]-e)/t):o}),s=g.default({x:r,y:o},function(t){var e=i(t,2),r=e[0],o=e[1];return function(t){return 1/(1+r*Math.pow(t,2*o))}},{damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01}).parameterValues,n=i(s,2);return{a:n[0],b:n[1]}}function M(t,e,r,o){return void 0===r&&(r=1),void 0===o&&(o=5),t.map(function(t,s,i){return -1===e[s]||-1===e[i]?t*Math.exp(-r):e[s]!==e[i]?t*Math.exp(-o):t})}function x(t){t=u.normalize(t,"max");var e=u.transpose(t),r=u.pairwiseMultiply(e,t);return t=u.add(t,u.subtract(e,r)),u.eliminateZeros(t)}function S(t,e,r){for(var o=m.zeros(t.length).map(function(t){return m.zeros(r[0].length)}),s=0;s<t.length;s++)for(var i=0;i<t[0].length;i++)for(var n=0;n<r[0].length;n++){var a=t[s][i];o[s][n]+=e[s][i]*r[a][n]}return o}e.findABParams=b,e.fastIntersection=M,e.resetLocalConnectivity=x,e.initTransform=S},32519:function(t,e,r){"use strict";var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}};function s(t,e){return Math.floor(e()*t)}Object.defineProperty(e,"__esModule",{value:!0}),e.tauRandInt=s;e.tauRand=function(t){return t()};function i(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}e.norm=function(t){var e,r,s=0;try{for(var i=o(t),n=i.next();!n.done;n=i.next()){var a=n.value;s+=Math.pow(a,2)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return Math.sqrt(s)},e.empty=i;function n(t,e){return i(t).map(function(){return e})}function a(t){return n(t,0)}e.range=function(t){return i(t).map(function(t,e){return e})},e.filled=n,e.zeros=a;e.ones=function(t){return n(t,1)};function h(t){return t.reduce(function(t,e){return t+e})}e.linear=function(t,e,r){return i(r).map(function(o,s){return t+s*((e-t)/(r-1))})},e.sum=h;e.mean=function(t){return h(t)/t.length};e.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e};e.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var o=0;o<t[r].length;o++)e=t[r][o]>e?t[r][o]:e;return e};e.rejectionSample=function(t,e,r){for(var o=a(t),i=0;i<t;i++){for(var n=!0;n;){for(var h=s(e,r),l=!1,u=0;u<i;u++)if(h===o[u]){l=!0;break}!l&&(n=!1),o[i]=h}}return o};e.reshape2d=function(t,e,r){var o=[],s=0,i=0;if(t.length!==e*r)throw Error("Array dimensions must match input length.");for(var n=0;n<e;n++){for(var a=[],h=0;h<r;h++)a.push(t[i]),i+=1;o.push(a)}return o}},316954:function(t,e,r){"use strict";r.r(e),r.d(e,{Matrix:function(){return s},inverse:function(){return i}});var o=r("810850");o.AbstractMatrix,o.CHO,o.CholeskyDecomposition,o.DistanceMatrix,o.EVD,o.EigenvalueDecomposition,o.LU,o.LuDecomposition;let s=o.Matrix;o.MatrixColumnSelectionView,o.MatrixColumnView,o.MatrixFlipColumnView,o.MatrixFlipRowView,o.MatrixRowSelectionView,o.MatrixRowView,o.MatrixSelectionView,o.MatrixSubView,o.MatrixTransposeView,o.NIPALS,o.Nipals,o.QR,o.QrDecomposition,o.SVD,o.SingularValueDecomposition,o.SymmetricMatrix,o.WrapperMatrix1D,o.WrapperMatrix2D,o.correlation,o.covariance,o.Matrix,o.Matrix,o.determinant;let i=o.inverse;o.linearDependencies,o.pseudoInverse,o.solve,o.wrap}}]);
//# sourceMappingURL=vendors~node_modules_umap-js_dist_index_js.main.js.map